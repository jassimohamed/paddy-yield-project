                                                                     # RandomForestRegressor

from sklearn.ensemble import RandomForestRegressor

rf_model = RandomForestRegressor(random_state=42)
print("RandomForestRegressor model instantiated as rf_model with random_state=42.")

print("Starting Random Forest model training...")
rf_model.fit(X_train, y_train)
print("Random Forest model training completed.")

y_pred_rf = rf_model.predict(X_test)
print("Predictions made on X_test and stored in y_pred_rf.")

from sklearn.metrics import r2_score, mean_absolute_error, mean_squared_error

# Calculate evaluation metrics for Random Forest
r2_rf = r2_score(y_test, y_pred_rf)
mae_rf = mean_absolute_error(y_test, y_pred_rf)
mse_rf = mean_squared_error(y_test, y_pred_rf)
rmse_rf = mse_rf**0.5

print(f"Random Forest Model Performance:")
print(f"R-squared: {r2_rf:.4f}")
print(f"Mean Absolute Error (MAE): {mae_rf:.2f}")
print(f"Mean Squared Error (MSE): {mse_rf:.2f}")
print(f"Root Mean Squared Error (RMSE): {rmse_rf:.2f}")




import matplotlib.pyplot as plt
import pandas as pd
import seaborn as sns

# Get the importance scores from the trained model
feature_importances = pd.Series(rf_model.feature_importances_, index=X.columns)

# Get the top 10 most important features
top_10_features = feature_importances.nlargest(10)

# Create a simple chart to visualize the importance
plt.figure(figsize=(10, 6))
top_10_features.plot(kind='barh')
plt.title('Top 10 Most Important Features for Paddy Yield Prediction (Random Forest)')
plt.xlabel('Importance Score')
plt.ylabel('Feature')
plt.gca().invert_yaxis() # Invert y-axis to have the most important feature at the top
plt.tight_layout()
plt.show()
